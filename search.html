<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>Moody Drinks</title>
    </head>
    <body>
        <div>
            <h2>Search Parameters</h2>
            <div class="name">
                <label>Cocktail Name</label>
                <input id="name" placeholder="Zipperhead">
            </div>
            <div class="button-container">
                <button id="name-search-btn">Search</button>
                <button class="clear">Clear</button>
            </div>
            <div class="ingredient">
                <label>Choose an Ingredient</label>
            </div>
            <div class="button-container">
                <button id="ingredient-search-btn">Search</button>
            </div>
            <div class="category">
                <label>Choose a Category</label>
            </div>
            <div class="button-container">
                <button id="category-search-btn">Search</button>
            </div>
        </div>
        <div class="results"></div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script type="text/javascript">
        $("#name-search-btn").on("click", function(e) {
            e.preventDefault();

            let name = $("#name").val();
            
            
            console.log(name);
            let nameURL = "https://www.thecocktaildb.com/api/json/v1/1/search.php?s=" + name;

            $.ajax({
                url: nameURL,
                method: "GET"
            }).then(function(response) {
                console.log(response);

                let results = response.drinks;

                let drinkIngredient = "";
                let drinkMesurement = "";
                let ingredients = "";

                if (results !== null) {
                    for (i = 0; i < results.length; i++) {
                    let drinkNameS = $("<p>").text(results[i].strDrink);
                    let drinkImageS = $("<img>").attr("src", results[i].strDrinkThumb);
                    let drinkInstrS = $("<p>").text(results[i].strInstructions);
                    let drinkIngredientS = $("<p>");
                    let drinkDivS = $("<div>");
                    
                    for (j = 1; j < 15; j++) {
                        if (results[i]["strIngredient" + j] != null) {
                        let drinkIngredient = results[i]["strIngredient" + j];
                        } else {
                        let drinkIngredient = "";
                        }

                        if (results[i]["strMeasure" + j] != null) {
                        let drinkMesurement = results[i]["strMeasure" + j];
                        } else {
                        let drinkMesurement = "";
                        }

                        if (drinkIngredient != "" || drinkMesurement != "") {
                        ingredients +=
                            "<span>" + drinkMesurement + " " + drinkIngredient + "</span>";
                        }
                    }

                    drinkIngredientS.text(ingredients);

                    drinkDivS.append(drinkNameS, drinkImageS, drinkInstrS, drinkIngredientS);
                    $(".results").append(drinkDivS);
                }
                }

                else {
                    $(".results").html("No results returned!")
                }
            })
        })

        $("#ingredient-search-btn").on("click", function(e) {
            e.preventDefault();

            

            let listURL = "https://www.thecocktaildb.com/api/json/v1/1/list.php?i=list";

            $.ajax({
                url: listURL,
                method: "GET"
            }).then(function(response) {
                console.log(response);

                let results2 = response.drinks;

                let list = $("<ul>");
                let listEl = "";
                let ingrEl = "";

                for (i = 0; i < results2.length; i++) {
                    let listEl = $("<li>");
                    let ingrEl = $("<input>").attr("value", results2[i].strIngredient1);
                    ingrEl.attr("type", "button");
                    ingrEl.addClass("list-element");
                    listEl.append(ingrEl);
                    list.append(listEl);

                    
                    
                }
                $(".results").append(list);

                let choiceDisplay = $("<div>");
                $(".results").append(choiceDisplay);
                

                $(".list-element").on("click", function() {
                    
                    let ingr = $(this).attr("value");
                    console.log(ingr);

                    let ingrURL = "https://www.thecocktaildb.com/api/json/v1/1/filter.php?i=" + ingr;

                    let yourChoice = $("<div>");
                    

                    $.ajax({
                        url: ingrURL,
                        method: "GET"
                    }).then(function(response) {
                        console.log(response);

                        let results4 = response.drinks;
                        let index=[];
                    

                        if (results4.length < 10) {
                            random = Math.floor(Math.random() * results4.length);
                            let drinkNameS = $("<p>").text(results4[random].strDrink);
                            let drinkImageS = $("<img>").attr("src", results4[random].strDrinkThumb);
                            let id = results4[random].idDrink;
                            let drinkInstrS = $("<p>");

                            let idURL = "https://www.thecocktaildb.com/api/json/v1/1/lookup.php?i=" + id;

                            $.ajax({
                                url: idURL,
                                method: "GET"
                            }).then(function(response) {
                                console.log(response);

                                drinkInstrS.text(response.drinks.strInstructions);
                            })

                            let drinkDivS = $("<div>");

                            drinkDivS.append(drinkNameS, drinkImageS, drinkInstrS);
                            yourChoice.append(drinkDivS);
                        }

                        else {
                            

                            for (i = 0; i < 5; i++) {
                                index[i] = Math.floor(Math.random() * results4.length);
                                let drinkNameS = $("<p>").text(results4[index[i]].strDrink);
                                let drinkImageS = $("<img>").attr("src", results4[index[i]].strDrinkThumb);
                                let drinkDivS = $("<div>");

                                drinkDivS.append(drinkNameS, drinkImageS);
                                yourChoice.append(drinkDivS);
                            }

                        }

                        
                        choiceDisplay.html(yourChoice);
                        

                        console.log(index);
                    })
                })
            })


            

            
        })

        $("#category-search-btn").on("click", function(e) {
            e.preventDefault();

            

            let categoryURL = "https://www.thecocktaildb.com/api/json/v1/1/list.php?c=list";

            $.ajax({
                url: categoryURL,
                method: "GET"
            }).then(function(response) {
                console.log(response);

                let results3 = response.drinks;

                let category = $("<ul>");
                let categoryEl = "";
                let cateEl = "";

                for (i = 0; i < results3.length; i++) {
                    let categoryEl = $("<li>");
                    let cateEl = $("<input>").attr("value", results3[i].strCategory);
                    cateEl.attr("type", "button");
                    cateEl.addClass("cate-element");
                    categoryEl.append(cateEl);
                    category.append(categoryEl);

                    
                    

                    
                }

                $(".results").append(category);
                let choiceDisplay = $("<div>");
                $(".results").append(choiceDisplay);

                $(".cate-element").on("click", function() {
                    
                    let cate = $(this).attr("value");
                    console.log(cate);

                    let cateURL = "https://www.thecocktaildb.com/api/json/v1/1/filter.php?c=" + cate;

                    let yourChoice = $("<div>");
                    

                    $.ajax({
                        url: cateURL,
                        method: "GET"
                    }).then(function(response) {
                        console.log(response);

                        let results5 = response.drinks;
                        let index=[];
                    

                        if (results5.length < 10) {
                            random = Math.floor(Math.random() * results5.length);
                            let drinkNameS = $("<p>").text(results5[random].strDrink);
                            let drinkImageS = $("<img>").attr("src", results5[random].strDrinkThumb);
                            let drinkDivS = $("<div>");

                            drinkDivS.append(drinkNameS, drinkImageS);
                            yourChoice.append(drinkDivS);
                        }

                        else {
                            

                            for (i = 0; i < 5; i++) {
                                index[i] = Math.floor(Math.random() * results5.length);
                                let drinkNameS = $("<p>").text(results5[index[i]].strDrink);
                                let drinkImageS = $("<img>").attr("src", results5[index[i]].strDrinkThumb);
                                let drinkDivS = $("<div>");

                                drinkDivS.append(drinkNameS, drinkImageS);
                                yourChoice.append(drinkDivS);
                            }

                        }

                        
                        choiceDisplay.html(yourChoice);
                        

                        console.log(index);
                    })


                })
            })
        })

            
        

        
 

        

        
        </script>
    </body>
</html>